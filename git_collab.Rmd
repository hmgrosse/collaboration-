---
title: "Final Project"
author: "Jonah Brumback, Hannah Grosse, and Jon Kazor"
date: "4/12/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#loading libraries
#my gt doesn't work, so I commented it out 
library(tidyverse)     # for data cleaning and plotting
library(gardenR)       # for Lisa's garden data
library(lubridate)     # for date manipulation
library(openintro)     # for the abbr2state() function
library(patchwork)     # for nicely combining ggplot2 graphs  
#library(gt)            # for creating nice tables
library(rvest)         # for scraping data
library(robotstxt)     # for checking if you can scrape data
library(janitor)       # for cleaning names

library(maps)          # for map data
library(ggmap)         # for mapping points on maps
library(gplots)        # for col2hex() function
library(RColorBrewer)  # for color palettes
library(sf)            # for working with spatial data
library(leaflet)       # for highly customizable mapping
library(ggthemes)      # for more themes (including theme_map())
library(plotly)        # for the ggplotly() - basic interactivity
library(gganimate)     # for adding animation layers to ggplots
library(transformr)    # for "tweening" (gganimate)
library(gifski)        # need the library for creating gifs but don't need to load each time
library(shiny)
theme_set(theme_minimal())
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
onebed_rent <- read_csv("City_MedianRentalPrice_1Bedroom.csv")
state_price <- read_csv("Sale_Prices_State.csv")
```


Tidy Tuesday Question: What is the average sale price by state, in March 2008?

```{r, fig.width=19, fig.height=14, fig.alt= "This graph shows the average sale price of houses, in March of 2008. The most expensive homes average $400,000 (California), and the most inexpensive homes are under $100,000 (Oklahoma). There are some states that data was nit collected from, and those states are gray."}
states_map<- map_data("state") 

state_price %>% 
  mutate(RegionName = str_to_lower(`RegionName`)) %>% 
  ggplot() + 
  geom_map(map = states_map,
           aes(map_id = RegionName,
               fill = `2008-03`,
               na.rm = TRUE)) +
  labs(title = "Average State Sale Price in March 2008", fill = "Sale Price", caption = "Graph by Hannah Grosse, data from Zillow, map from map_data") +
  expand_limits(x = states_map$long, y = states_map$lat) + 
  scale_fill_viridis_c(option = "rocket", direction = -1) +
  theme_map() + 
  theme(legend.background = element_blank())
```


```{r}
state_price_averages <- state_price %>% 
  mutate( mean_price_2008 = rowMeans(select(.,`2008-03`:`2008-12`)), na.rm=TRUE,
          mean_price_2009 = rowMeans(select(.,`2009-01`:`2009-12`)), na.rm=TRUE,
          mean_price_2010 = rowMeans(select(.,`2010-01`:`2010-12`)), na.rm=TRUE,
          mean_price_2011 = rowMeans(select(.,`2011-01`:`2011-12`)), na.rm=TRUE,
          mean_price_2012 = rowMeans(select(.,`2012-01`:`2012-12`)), na.rm=TRUE,
          mean_price_2013 = rowMeans(select(.,`2013-01`:`2013-12`)), na.rm=TRUE,
          mean_price_2014 = rowMeans(select(.,`2014-01`:`2014-12`)), na.rm=TRUE,
          mean_price_2015 = rowMeans(select(.,`2015-01`:`2015-12`)), na.rm=TRUE,
          mean_price_2016 = rowMeans(select(.,`2016-01`:`2016-12`)), na.rm=TRUE,
          mean_price_2017 = rowMeans(select(.,`2017-01`:`2017-12`)), na.rm=TRUE,
          mean_price_2018 = rowMeans(select(.,`2018-01`:`2018-12`)), na.rm=TRUE,
          mean_price_2019 = rowMeans(select(.,`2019-01`:`2019-12`)), na.rm=TRUE) %>% 
  select(RegionName, mean_price_2008, mean_price_2009, mean_price_2010, mean_price_2011, mean_price_2012, mean_price_2013, mean_price_2014, mean_price_2015, mean_price_2016, mean_price_2017, mean_price_2018, mean_price_2019)

state_price_averages

#colMeans(state_price[5,6], na.rm = TRUE)
```




```{r}
#have to edit with new means values shared by Jonah
states_map<- map_data("state") 

state_price_map <- state_price %>% 
  mutate(RegionName = str_to_lower(`RegionName`)) %>% 
  ggplot() + 
  geom_map(map = states_map,
           aes(map_id = RegionName,
               fill = `2008-03`,
               na.rm = TRUE)) +
  labs(title = "Average State Sale Price in March 2008", 
       fill = "Sale Price", 
       caption = "Graph by Hannah Grosse, data from Zillow, map from map_data") +
  expand_limits(x = states_map$long, y = states_map$lat) + 
  scale_fill_viridis_c(option = "rocket", direction = -1) +
  theme_map() + 
  theme(legend.background = element_blank()) + 
  transition_states(date, transition_length = 0)

#animate(state_price_map, nframes = 200, end_pause = 10) 

#idk if I need to do this, just did it for the other code ran/animated
#state_price %>% 
  #mutate(RegionName = str_to_lower(`RegionName`))
```


```{r}
city_price <- read_csv("Sale_Prices_City.csv")
```
```{r}
#change to dots/points filling the cities/not the right graph for the city version
states_map<- map_data("state") 

city_price %>% 
  mutate(RegionName = str_to_lower(`RegionName`)) %>% 
  ggplot() + 
  geom_map(map = states_map,
           aes(map_id = RegionName,
               fill = `2008-03`,
               na.rm = TRUE)) +
  labs(title = "Average State Sale Price in March 2008", fill = "Sale Price", caption = "Graph by Hannah Grosse, data from Zillow, map from map_data") +
  expand_limits(x = states_map$long, y = states_map$lat) + 
  scale_fill_viridis_c(option = "rocket", direction = -1) +
  theme_map() + 
  theme(legend.background = element_blank())
```


## Including Plots

You can also embed plots, for example:

```{r}

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
